---
description: 测试覆盖率标准
globs:
  - "**/*.test.ts"
  - "**/*.spec.ts"
---

# 测试覆盖率

## 覆盖率目标

| 代码类型 | 最低 | 理想 |
|---------|------|------|
| 核心业务逻辑 | 80% | 90%+ |
| 工具函数 | 90% | 95%+ |
| API 层 | 70% | 80%+ |
| UI 组件 | 60% | 70%+ |

## 测试金字塔

```
      /\
     /  \     E2E (10%)
    /----\
   /      \   Integration (20%)
  /--------\
 /          \ Unit (70%)
--------------
```

## 何时需要测试

| 改动类型 | 测试要求 |
|---------|---------|
| 业务逻辑变更 | ✅ 必须 |
| 新增功能 | ✅ 必须 |
| Bug 修复 | ✅ 添加回归测试 |
| 纯样式调整 | ⚠️ 可选 |
| 配置变更 | ⚠️ 可选 |

## Vitest 配置

```typescript
// vitest.config.ts
export default {
  test: {
    coverage: {
      provider: 'v8',
      thresholds: { lines: 80, functions: 80, branches: 80 },
    },
  },
};
```
