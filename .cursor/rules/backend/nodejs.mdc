---
description: Node.js 和 Express.js 后端开发最佳实践，包含 MongoDB、JWT 等
globs:
  - "**/*.js"
  - "**/*.ts"
  - "src/**/*.ts"
  - "**/package.json"
alwaysApply: false
---

# Node.js 和 Express.js 最佳实践

## 技术栈
- Backend: Node.js with Express.js
- Database: MongoDB with Mongoose ODM（如适用）
- Authentication: JSON Web Tokens (JWT)（如适用）
- Version Control: Git
- Deployment: Docker（可选）

## 项目结构
- 使用适当的目录结构
- 实现适当的模块组织
- 使用适当的中间件组织
- 按域组织路由
- 实现适当的错误处理
- 使用适当的配置管理

## Express 设置
- 使用适当的中间件设置
- 实现适当的路由
- 使用适当的错误处理
- 配置适当的安全中间件
- 实现适当的验证
- 使用适当的静态文件服务

## API 设计
- 使用适当的 REST 原则
- 实现适当的版本控制
- 使用适当的请求验证
- 正确处理错误
- 实现适当的响应格式
- 适当记录 API

## 数据库集成
- 使用适当的 ORM/ODM（如 Mongoose）
- 实现适当的迁移
- 使用适当的连接池
- 实现适当的事务
- 使用适当的查询优化
- 正确处理数据库错误

## 认证和授权
- 实现适当的 JWT 处理
- 使用适当的密码哈希
- 实现适当的会话管理
- 使用适当的 OAuth 集成
- 实现适当的基于角色的访问控制
- 正确处理认证错误

## 安全
- 使用适当的 CORS 设置
- 实现适当的速率限制
- 使用适当的安全头
- 实现适当的输入验证
- 使用适当的加密
- 处理安全漏洞

## 性能
- 使用适当的缓存
- 实现适当的异步操作
- 使用适当的连接池
- 实现适当的日志记录
- 使用适当的监控
- 正确处理高流量

## 错误处理
- 实现全局错误处理中间件
- 使用适当的错误类型
- 提供用户友好的错误消息
- 记录错误详细信息
- 正确处理异步错误
- 实现适当的错误响应格式

## 测试
- 编写适当的单元测试
- 实现适当的集成测试
- 使用适当的测试运行器
- 实现适当的模拟
- 测试错误场景
- 使用适当的测试覆盖率

## 部署
- 使用适当的 Docker 设置
- 实现适当的 CI/CD
- 使用适当的环境变量
- 配置适当的日志记录
- 实现适当的监控
- 处理部署错误

## 代码质量
- 遵循 Node.js 最佳实践
- 使用适当的 async/await
- 实现适当的错误处理
- 使用适当的日志记录
- 正确处理进程信号
- 适当记录代码

## 最佳实践
- 使用 TypeScript 以获得更好的类型安全（如适用）
- 实现适当的代码组织
- 使用适当的命名约定
- 保持代码简洁和可维护
- 实现适当的文档
- 遵循编码标准
