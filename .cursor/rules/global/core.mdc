---
description: 核心开发规范，包含代码质量检查要求和响应语言设置，适用于所有场景。
globs: 
alwaysApply: true
---

# 核心开发规范

## 代码质量检查（必须执行）
每次输出代码后，**必须按顺序执行以下检查**：

### 1. 语法与编译检查
- 检查语法是否正确，能否正常编译/运行
- 检查是否有未导入的模块或类型
- 检查是否有未使用的导入语句
- 验证所有依赖项是否已正确安装和配置

### 2. Lint 错误修复
- **必须运行 linter 检查**（如 ESLint、TSLint、rustfmt、clippy 等）
- 修复所有 lint 错误和警告
- 确保代码符合项目的 lint 配置
- 在提交代码前确保所有 lint 检查通过

### 3. 类型完整性检查
- **TypeScript/Java/Rust**：检查所有函数参数、返回值是否已声明类型
- 禁止使用 `any`（TypeScript）或未标注类型，优先使用 `unknown` 或具体类型
- 补充缺失的类型定义
- 确保类型定义已放入 `types/` 目录（如适用）
- 检查类型是否与实际实现一致

### 4. 代码抽离与复用（DRY 原则）
- **检查重复代码**：识别是否存在重复逻辑，必须抽离为公共函数/组件
- **公共逻辑抽离**：
  - 相同或相似的函数 → 提取到 `utils/` 或 `common/`
  - 相同的组件逻辑 → 提取为自定义 Hook/Composable/函数
  - 相同的业务逻辑 → 提取到 Service/Repository 层
- **禁止复制粘贴**：严禁在多个位置复制粘贴相同代码
- **单一职责**：每个函数/组件只做一件事

### 5. 无用代码清理
- 删除未使用的变量、函数、导入
- 删除注释掉的代码
- 删除调试用的 `console.log`、`println!` 等
- 删除未使用的类型定义
- 删除死代码（永远不会执行的代码）
- **删除临时脚本**：任务完成后必须删除所有临时脚本文件（如迁移脚本、一次性工具脚本等）

### 6. 逻辑完整性检查
- 检查是否有遗漏的边界情况（空值、异常、边界值）
- 检查错误处理是否完整
- 检查资源释放（如文件句柄、数据库连接）
- 检查并发安全性（如适用）
- 检查内存泄漏风险

### 7. JSDoc 注释完整性检查（必须执行）
- **所有函数必须包含 JSDoc 注释**：检查是否有 `@description` 或描述文本
- **参数注释检查**：所有函数参数必须包含 `@param` 标签，说明名称和用途
- **返回值注释检查**：所有函数返回值必须包含 `@returns` 标签，说明含义
- **异常注释检查**：可能抛出异常的函数必须包含 `@throws` 标签
- **示例代码检查**：复杂函数必须包含 `@example` 标签，展示使用方法
- **类和方法注释**：所有类必须包含 `@class` 和 `@description`，所有方法必须有完整注释
- **组件注释**：React/Vue 组件必须包含完整的 props、emits、slots 说明
- **注释准确性**：确保注释描述与实际实现一致
- **重要**：TypeScript 文件（.ts, .tsx）在 JSDoc 中**不要**包含类型标注（如 `{number}`, `{string}`），类型信息已在函数签名中；JavaScript 文件（.js, .jsx）**必须**包含类型标注

### 8. 命名与风格检查
- 检查是否符合命名约定（组件 PascalCase，函数 camelCase）
- 检查是否符合代码风格规范
- 检查导入顺序是否符合规范
- 检查代码格式是否一致（缩进、空格、换行）

### 9. 性能与安全
- 检查是否存在性能瓶颈
- 检查是否有安全漏洞（SQL 注入、XSS、CSRF 等）
- 检查敏感信息是否硬编码
- 检查输入验证是否充分

## 执行流程
1. **编写代码**（首先生成 JSDoc 注释，然后写实现代码）
2. **执行上述 9 项检查**（必须逐项完成）
3. **修复发现的问题**
4. **再次验证**（确保修复后无新问题）
5. **输出最终代码**

## 代码质量原则

### SOLID 原则
- **单一职责原则（SRP）**：每个类/函数应该只有一个改变的理由
- **开闭原则（OCP）**：对扩展开放，对修改关闭
- **里氏替换原则（LSP）**：子类应该能够替换其基类
- **接口隔离原则（ISP）**：不应该强迫客户端依赖它们不使用的接口
- **依赖倒置原则（DIP）**：高层模块不应该依赖低层模块，两者都应该依赖抽象

### DRY 原则（Don't Repeat Yourself）
- 避免代码重复
- 提取公共逻辑
- 维护单一数据源

### KISS 原则（Keep It Simple, Stupid）
- 保持代码简单
- 避免过度设计
- 优先选择简单直接的解决方案

### YAGNI 原则（You Aren't Gonna Need It）
- 不要实现当前不需要的功能
- 避免过早优化
- 专注于当前需求

## 响应语言
- 所有回复必须使用**简体中文**
- 代码注释应使用**英文**（技术术语）或**中文**（业务逻辑说明）
